
import java.sql.*;
import java.util.*;
public class MySQL{
	
	private Statement stmt = null;
	private Connection conn = null;
	private String user = null;
	private int ID = 0;
	public MySQL(String name){
		user = name;
		String url = "jdbc:mysql://localhost:3306/";
		String dbName = "serwis";
		String driver = "com.mysql.jdbc.Driver";
		String userName = "root";
		String password = "";
		try {
			Class.forName(driver).newInstance();
			conn = DriverManager.getConnection(url+dbName,userName,password);
			stmt = conn.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE);	
			} catch (Exception e) {
				e.printStackTrace();
			}
			ResultSet rs;
			//pobranie ID Klienta który aktualnie siê zalogowa³ OK
		try {
				System.out.println(name);
				rs = stmt.executeQuery("Select * from client where client_name = '"+name+"'");
				
				while(rs.next())
					ID = rs.getInt("client_id");
				
			} catch (SQLException e) {
				e.printStackTrace();
			}
			

		
		
}
public String getPassword(){//Pobranie has³a dla klienta OK
	ResultSet rs;
	String password = null;
	try {
		rs = stmt.executeQuery("Select * from client_password where client_id = '"+ID+"'");
		while(rs.next())
			password = rs.getString("password");
		
	} catch (SQLException e) {
		e.printStackTrace();
	}

	return password;
}
public String [][]Command(String command) throws SQLException{
	//W tej klasie s¹ wykonywane wszystkie zapytania do bazy MySQL
	
	String Wynik [][] = null;
	String  wun  = null;
	int j = 0;
			ResultSet rs = stmt.executeQuery(command);
			ResultSetMetaData rsmd = rs.getMetaData();
			int columnNumber = rsmd.getColumnCount();
			//wyswietlanie nazw kolumn:
            for (int i = 1; i <= columnNumber; i++) { 
             System.out.print(rsmd.getColumnLabel(i)+"  |  "); 
             Wynik[0][i] = rsmd.getColumnLabel(i);
            }
            System.out.print("\n------------------------------------\n");

            //wyswietlanie kolejnych rekordow:
            while (rs.next()) {
                for (int i = 1; i <= columnNumber; i++) {
               	   	 Object obj = rs.getObject(i);
                     if (obj != null){
                    	 System.out.print(obj.toString()+ " | ");
                    	 Wynik[j][i] = obj.toString();
                     }
                     else  System.out.print(" ");
                   }
                j++;
                System.out.println();
            }
			System.out.println(Wynik);
	
	return Wynik;
 	}
	
public void Close() throws SQLException{
	conn.close();
}



}